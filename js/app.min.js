window.addEventListener("DOMContentLoaded",function(){"use strict";function e(e){var n="";["type","id","threadId","body","delivery","deliveryStatus","read","receiver","sender","timestamp","messageClass"].forEach(function(s){n+="<br> "+s+": "+e[s]}),console.log(n)}function n(){$(".button-collapse").sideNav({menuWidth:200,edge:"left",closeOnClick:!0});var e=navigator.mozContacts.getAll();e.onsuccess=function(e){var n,s,t,o=e.target;o.result?(console.log("Found one contact..."),n=null==o.result.givenName?"":o.result.givenName[0],s=null==o.result.familyName?"":o.result.familyName[0],t=null==o.result.tel?"":o.result.tel[0].value,console.log("Given name : "+n+", Family name : "+s+", Tel : "+t),$("#contacts").append('<option value="'+t+'">'+n+" "+s+"</option>"),o.continue()):(console.log("No more contacts, creating the Materialize select..."),$("select").material_select())},e.onerror=function(){console.warn("Something went terribly wrong while retrieving the contacts!")}}var s=document.getElementById("nav-slide");null!=s?(console.log("Successfully retrieved nav-slide"),$("#nav-slide").load("../slide.html")):console.log("Error while retrieving nav-slide");var t=-1;$("#sms-submit").on("click",function(){console.log("Submitting SMS form...");var n=document.getElementById("response");null==n&&$("#main-section").append('<div class="row"><div id="response"></div></div>'),$("#response").html("Submitting SMS...");var s=document.getElementById("message").value,o=document.getElementById("contacts").value;console.log("Submitted message : "+s+" Phone nb: "+o);var r;r=navigator.mozMobileMessage.send(o,s),r.onsuccess=function(){window.thing=this,console.log(this.result),console.log("Sent to: "+this.result),t=this.result.id,e(this.result),$("#response").html("<span>Successfully sent ✓</span><br/>");var n=window.setInterval(function(){if(-1!=t){var s=navigator.mozMobileMessage.getMessage(t);s.onsuccess=function(){window.thing=this,console.error(this.result),"success"==this.result.deliveryStatus&&(clearInterval(n),$("#response").append("<span>Successfully received ✓</span>")),e(this.result)},s.onerror=function(){$("#response").html("<span>Couldn't retrieve last sent SMS...</span>"),clearInterval(n)}}},5e3)},r.onerror=function(){window.thing=this,console.error(this.error.name),console.error(this.error.message),$("#response").html("<span>Error while sending the message ✗</span>"),$("#response").append("<span>"+this.error.name+":"+this.error.message+"</span>")}});navigator.mozL10n.get;navigator.mozL10n.once(n)});