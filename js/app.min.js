window.addEventListener("DOMContentLoaded",function(){"use strict";function e(e){var t="";["type","id","threadId","body","delivery","deliveryStatus","read","receiver","sender","timestamp","messageClass"].forEach(function(n){t+="<br> "+n+": "+e[n]}),$("#response").html(t)}function t(){$(".button-collapse").sideNav({menuWidth:200,edge:"left",closeOnClick:!0});var e=navigator.mozContacts.getAll();e.onsuccess=function(e){var t,n,o,s=e.target;s.result?(console.log("Found one contact..."),t=null==s.result.givenName?"":s.result.givenName[0],n=null==s.result.familyName?"":s.result.familyName[0],o=null==s.result.tel?"":s.result.tel[0].value,console.log("Given name : "+t+", Family name : "+n+", Tel : "+o),$("#contacts").append('<option value="'+o+'">'+t+" "+n+"</option>"),s.continue()):(console.log("No more contacts, creating the Materialize select..."),$("select").material_select())},e.onerror=function(){console.warn("Something went terribly wrong while retrieving the contacts!")}}var n=-1;$("#sms-submit").on("click",function(){console.log("Submitting SMS form..."),$("#main-section").append('<div class="row"><div id="response"></div></div>'),$("#response").html("Submitting form...");var t=document.getElementById("message").value,o=document.getElementById("contacts").value;console.log("Submitted message : "+t+" Phone nb: "+o);var s;s=navigator.mozMobileMessage.send(o,t),s.onsuccess=function(){window.thing=this,console.log(this.result),console.log("Sent to: "+this.result),n=this.result.id,e(this.result);var t=window.setInterval(function(){if(-1!=n){var o=navigator.mozMobileMessage.getMessage(n);o.onsuccess=function(){window.thing=this,console.error(this.result),"success"==this.result.deliveryStatus&&clearInterval(t),e(this.result)},o.onerror=function(){$("#response").html("Couldn't retrieve last sent SMS..."),clearInterval(t)}}},5e3)},s.onerror=function(){window.thing=this,console.error(this.error.name),console.error(this.error.message),$("#response").html(this.error.name+":"+this.error.message)}});navigator.mozL10n.get;navigator.mozL10n.once(t)});