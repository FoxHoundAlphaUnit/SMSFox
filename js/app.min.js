window.addEventListener("DOMContentLoaded",function(){"use strict";function e(e){["type","id","threadId","body","delivery","deliveryStatus","read","receiver","sender","timestamp","messageClass"].forEach(function(o){$("#response").append("<br> "+o+": "+e[o])})}function o(){$(".button-collapse").sideNav({menuWidth:200,edge:"left",closeOnClick:!0});var e=navigator.mozContacts.getAll();e.onsuccess=function(e){console.log("allContacts.onsuccess event");var o,t,n,s=e.target;s.result?(console.log("Found: "),o=null==s.result.givenName?"":s.result.givenName[0],console.log("Given name : "+o),t=null==s.result.familyName?"":s.result.familyName[0],console.log("Family name : "+t),n=null==s.result.tel?"":s.result.tel[0].value,console.log("Tel : "+n),$("#contacts").append('<option value="'+n+'">'+o+" "+t+"</option>"),s.continue()):(console.log("No more contacts"),$("select").material_select())},e.onerror=function(){console.warn("Something went terribly wrong while retrieving the contacts!")}}var t=-1;$("#sms-submit").on("click",function(o){console.log("Submitting form"),$("#response").html("submit form"),o.preventDefault(),o.stopPropagation();var n,s=$("[name=msg]").val(),r=$("[name=phone]").val();$("#response").html("got values"),n=navigator.mozMobileMessage.send(r,s),$("#response").html("tried to send message"),$("#response").html("iterate through requests"),n.onsuccess=function(){window.thing=this,console.error(this.result),$("#response").html("Sent to <br>"+this.result),t=this.result.id,e(this.result)},n.onerror=function(){window.thing=this,console.error(this.error.name),console.error(this.error.message),$("#response").html(this.error.name+":"+this.error.message)}}),window.setInterval(function(){if(-1!=t){var o=navigator.mozMobileMessage.getMessage(t);o.onsuccess=function(){window.thing=this,console.error(this.result),e(this.result)},o.onerror=function(){$("#response").html("SHIIIT!!!")}}},5e3);navigator.mozL10n.get;navigator.mozL10n.once(o)});